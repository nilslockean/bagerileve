---
import ButtonLink from "@components/ButtonLink.astro";
import Section from "@components/Section.astro";
import Layout from "src/layouts/Layout.astro";
import { sanityAsset as sa } from "@lib/sanityAsset";
import { fetchOrderTerms } from "@lib/sanity";
import Accordion from "@components/Accordion.astro";
import { PortableText } from "astro-portabletext";

const sanityAsset = (filename: string) =>
  sa(
    filename,
    import.meta.env.SANITY_PROJECT_ID,
    import.meta.env.SANITY_DATASET
  );

const orderTerms = await fetchOrderTerms();
---

<Layout
  title="Beställ"
  metaDescription="Beställ dina fredagsmunkar i förväg och hämta enkelt upp vid vald tid."
>
  <Section>
    <h1>Beställ dina fredagsmunkar</h1>
    <p class="text-2xl leading-relaxed max-w-prose mb-8">
      Fredagar på Bageri Leve bjuder på nya veganska munkar varje vecka - så
      populära att köerna ibland ringlar sig långt utanför dörren. Förbeställ
      idag för en garanterad smakupplevelse!
    </p>
    <div class="grid lg:grid-cols-2 gap-8">
      <video class="w-full" controls>
        <source
          src={sanityAsset("3ec535d941d8f39f570f7ba06d2dc4725f8351e0.mp4")}
          type="video/mp4"
        />
      </video>

      <div>
        <div class="p-4 border-4 border-current max-w-prose">
          <h2 class="text-2xl">Gör såhär:</h2>

          <ol>
            <li>Gå till online-beställningen (men läs klart detta först).</li>
            <li>Skapa ett konto med Facebook eller din email och logga in.</li>
            <li>Välj antal munkar du önskar beställa.</li>
            <li>Betala med Swish.</li>
            <li>
              Du kommer nu få ett bekräftelsemail från kvitto@trueapp.se med
              ditt ordernummer.
            </li>
            <li>Klart!</li>
          </ol>

          <p>
            Nu behöver du bara komma på fredagen under Leves öppettider och säga
            ditt ordernummer. Ifall du vill handla något annat på plats går det
            självklart också bra!
          </p>
        </div>
        <ButtonLink
          variant="primary"
          href="https://web.trueapp.se/bagerileve/store1/"
          target="_blank"
          rel="noreferrer"
        >
          Till online-beställningen
        </ButtonLink>
      </div>
    </div>
  </Section>
  <Section>
    <h2 class="mb-8">Beställningsvillkor</h2>
    {
      orderTerms.map(({ title, content, sortOrder }) => (
        <Accordion
          id={`order-term-${sortOrder}`}
          title={title}
          class="mb-4 last:mb-0 portable-text"
        >
          <PortableText value={content} />
        </Accordion>
      ))
    }
  </Section>
</Layout>

<style>
  ol {
    @apply list-decimal list-inside;
  }

  li {
    @apply mb-4;
  }

  p {
    @apply max-w-prose;
  }
</style>
